<!DOCTYPE html>
<html lang="ru">
<head>

  @@include("source/html/base/head.html")
  <title>Лига компонентов</title>

</head>
<body>

  <div style="display: none;">
    @@include("build/img/sprite_auto.svg")
  </div>

  <div class="wrapper">
    @@include("source/html/base/header.html")

    <main>
      <div class="container">
        <div class="component">
          <div class="component__heading">
            <h1 class="component__title">Модальные окна</h1>
            <a class="component__download-link btn" href="components/modals.zip" download>Скачать компонент</a>
          </div>
          <div class="component__description">
            <h2 class="component__subtitle">Описание</h2>
            <p>Модальные окна полностью переписаны, сейчас используется делегирование как при открытии так и в самом модальном окне <em>=></em> как следствие отсутствуют проблемы с динамическим добавлением элементов: кнопок вызова и самих модальных окон</p>
            <p>В файле init-modals.js создаётся экземпляр класса Modals который записывается в переменную modals, им вы можете пользоваться по проекту при необходимости, так же он записывается в window.modals. <em>Используйте в разработке экспортируемую переменную modals, window сделан для бэкэнда</em></p>
            <p>Модальные окна состоят из следующих файлов: ios-checker.js, focus-lock.js, scroll-lock.js, modals.js, init-modals.js, и modal.scss все файлы обязательны к переносу в проект! Так же у вас в проекте должно находится два утилитарных класса для блокировки страницы:</p>
            <pre>
              <code>
                .scroll-lock-ios {
                  position: fixed;

                  overflow: hidden;
                }

                .scroll-lock {
                  overflow: hidden;
                }
              </code>
            </pre>
            <h2 class="component__subtitle">Обязательные data атрибуты</h2>
            <p><em>data-open-modal="Имя модального окна"</em> Устанавливается на кнопке вызова модального окна</p>
            <p><em>data-modal="Имя модального окна"</em> Устанавливается на модальном окне</p>
            <p><em>data-close-modal</em> Устанавливается на элементе который должен закрыть модальное окно, по умолчанию установлен на оверлее и на кнопки закрытия, может добавлятся на любые элементы в модальном окне.</p>
            <h2 class="component__subtitle">Не обязательные data атрибуты</h2>
            <p><em>data-focus</em> Устанавливается на том элементе который при открытии модального окна должен попатсть в фокус, если не установить то в фокус попадёт первый интерактивный элемент в модальном окне. Данный data атрибут не относится к модулю модальных окон, он относится к модулю блокировки фокуса внутри модального окна</p>
            <h2 class="component__subtitle">Настройки</h2>
            <p>При создании экземпляра класса передаются настройки в формате ключ - "Имя модального окна" значение - обьект</p>
            <p>По умолчанию работаю настройки по умолчанию</p>
            <p><em>preventDefault</em> Отмена действия по умолчанию, по умолчанию true</p>
            <p><em>stopPlay</em> Остановка проигрывание стандартных HTML элементов video и audio, по умолчанию true</p>
            <p><em>lockFocus</em> Блокировка фокуса внутри модального окна, по умолчанию true. Если внутри модального окна нет фокусируемых элементов то при нажатии на клавишу tab или сочетание shift + tab действие по умолчанию будет отменено. Если внутри модального окна есть только один фокусируемый элемент то при нажатии на клавишу tab или сочетание shift + tab фокус с него уходить не будет.</p>
            <p><em>startFocus</em> Блокировка фокуса внутри модального окна, по умолчанию true. Если поставить false то при открытии ни один из элементов модального окна не попадёт в фокус</p>
            <p><em>focusBack</em> При закрытии модального окна возвращает фокус на тот элемент который находился в фокусе перед открытием модального окна, по умолчанию true</p>
            <p><em>eventTimeout</em> Таймаут который отрабатывает при разблокировке скрола при закрытии, по умолчанию 400мс, добавлен для того что бы сгладить появление полосы прокрутки, убрать дёрганье модального окна + через данный таймаут снимаются и вешаются обработчики на модальное окно и документ это сделано для того что бы убрать баги связвнный с добавлением лока фокуса внутри модального окна так как при зажатой клафише enter и при фокусе кнопки закоытия в модальном окне оно начинает открываться и закрываться что приводит к багам с появлением полосы прокрутки и тд</p>
            <p><em>openCallback</em> Callback при открытии, по умолчанию false</p>
            <p><em>closeCallback</em> Callback при закрытии, по умолчанию false</p>
            <pre>
              <code>
                const settings = {
                  'default': {
                    preventDefault: true,
                    stopPlay: true,
                    lockFocus: true,
                    eventTimeout: 400,
                    openCallback: false,
                    closeCallback: false,
                  },
                  // modal-1 добавлен исключительно для примера при добавлении на проект ключ и обект записанный в нём нужно удалить
                  'modal-1': {
                    openCallback: () => console.log('Я отработаю при открытии modal-1'),
                    closeCallback: () => console.log('Я отработаю при закрытии modal-1'),
                  },
                };
              </code>
            </pre>
            <h2 class="component__subtitle">Методы</h2>
            <p><em>modals.open("Имя модального окна")</em> Открывает переданное модальное окно</p>
            <p><em>modals.close("Имя модального окна")</em> Закрывает переданное модальное окное</p>
            <h2 class="component__subtitle">Дополнения</h2>
            <p>Так же в файле инициализации есть закоменченый код. Он добавлен для открытия нового модального окна из колбэка закрытия. Судьба его пока не известна, так как кейс крайне редкий и все случаи которые пока были на практике перекрывает метод modals.open('Имя модального окна'), например показ модального окна с сообщением об успешной отправки формы в случае если сама форма находилась в модальном окне</p>
              <pre>
                <code>
                  // Здесь реализован пример открытия модалки через колбэк закрытия
                  // const openModalInCloseCallback = (name, context = this) => {
                  //   context._enableScrolling = false;
                  //   context._setSettings('default');
                  //   modals.open(name);
                  // };

                  // closeCallback() {
                  //   openModalInCloseCallback('modal-5');
                  // },
                </code>
              </pre>
            <h2 class="component__subtitle">Добавление Youtube видео</h2>
            <p>Добавлена автоматическая остановка воспроизведения Youtube видео и при необходимости автозапуск воспроизведения при открытии</p>
            <p>Для корректной работы <em>iframe</em> должен быть обёрнут в <em>div</em> с дата атрибутом <em>data-iframe</em>. <em>Важно!!!</em> в src iframe в конце должно быть дописано <em>?enablejsapi=1</em>. Полный пример src: src="https://www.youtube.com/embed/FmzHq3U0UFE?enablejsapi=1". Примеры в модальных окнах 4 и 5</p>
            <p>Для автовоспроизведения <em>div</em> нужно добавить дата атрибут <em>data-auto-play</em>. Пример в модальном окне 5</p>
          </div>
          <h2 class="component__subtitle">Демо</h2>
          <div class="component__demo">
            @@include("source/components/modals/modals.html")
        </div>
      </div>
    </main>
  </div>

  <script src="js/vendor.min.js"></script>
  <script src="js/main.min.js"></script>
</body>
</html>
